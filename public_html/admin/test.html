<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<form enctype="multipart/form-data" method="post" id="g">
    id<input id="id" name="id" value="1" /><br />
    <input id="image" name="photo" type="file" />
    <input type="button" id="click" value="Upload" />
</form>
<progress id="h"></progress>
<script type='text/javascript' src='../site/js/vendor/jquery-2.1.1.js'></script>
<script src="js/validator.js"></script>
<script src="js/ajax.js"></script>

<script>

    $('#click').click(function(){
        ajax.load_image(
                new FormData(document.getElementById('g')),
                {
                    success: function(data) { console.log(data); },
                    error: function(error) { console.log(error); },
                    before: function() { console.log('before'); },
                    after: function() { console.log('after'); }
                },
                progressHandlingFunction
        );
        return false;
    });

    function progressHandlingFunction(e){
        if(e.lengthComputable){
            $('#h').attr({value:e.loaded,max:e.total});
        }
    }
</script>

</body>
</html>